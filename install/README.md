# Installing and Using ExSHalos

This guide provides three methods for installing `ExSHalos` in an isolated, reproducible environment. This is the strongly recommended approach as it handles all system and Python dependencies for you.

### Prerequisites

You must have `git` and one of the following tools installed on your system:
*   [Docker](https://www.docker.com/get-started) (or a compatible alternative like [Podman](https://podman.io/))
*   [Apptainer](https://apptainer.org/docs/user/main/installation.html)
*   [Nix](https://nixos.org/download.html)

---

## Getting Started: Initial Setup

First, clone the repository and navigate into the project directory. All commands in the sections below assume you are running them from this `ExSHalos` directory.

```bash
git clone https://github.com/Voivodic/ExSHalos.git
cd ExSHalos
```

---

## Installation Options

After completing the initial setup, choose **one** of the following methods to create your environment.

### Option 1: Docker

Docker allows you to build a container image with all dependencies included.

**1. Build the Image**

```bash
docker build -t your_image_name -f install/Dockerfile .
```
Replace `your_image_name` with the name you want to give your image.

**2. Run Your Code**

To run a Python script, mount your current directory into the container. The container will execute your script using its internal Python interpreter.

```bash
# This command runs 'your_script.py' inside the container
docker run --rm -v ./:/Workspace your_image_name your_script.py
```
Any files generated by your script will appear in your current directory on your host machine.

**3. Start an Interactive Shell**

If you want to explore the container's environment or run commands interactively, start a `bash` shell.

```bash
# This command overrides the default entrypoint to give you a shell
docker run --rm -it -v ./:/Workspace your_image_name 
```

### Option 2: Apptainer

Apptainer is a popular container runtime in scientific and HPC environments.

**1. Build the Image**

This command creates a single, executable container file (`exshalos.sif`).

```bash
# Building requires sudo or a --fakeroot setup
sudo apptainer build your_container_name.sif install/apptainer.def
```
Replace `your_container_name` with the name you want to give your container.

**2. Run Your Code**

To run a Python script, you can use the container directly as an executable.

```bash
./your_container_name.sif your_script.py
```

**3. Start an Interactive Shell**

To explore the container's environment:

```bash
apptainer shell your_container_name.sif
```

### Option 3: Nix

Nix allows you to create a reproducible development shell or run your code directly using the `flake.nix` file in this repository.

**1. Start an Ephemeral Shell**

This command downloads all dependencies and gives you a `bash` shell where `python` and the `pyexshalos` library are available. Differently from the other methods, this shell is not isolated from your base system, and you can still use all you programs.

```bash
nix develop install/.
```
Inside this shell, you can run your code directly: `python your_script.py`.

**2. Run a Script Directly**

To execute a script without first entering an interactive shell:

```bash
nix run install/. -- your_script.py
```
> **Note:** The `--` is important. It separates the arguments for `nix run` from the arguments for your script.

The `pyexshalos` package can also be used as a dependency in other Nix flakes. See the [Voivodic/nix-derivations](https://github.com/Voivodic/nix-derivations) repository for more information.
